- @title = 'Sites'
- @menu_title = "#{@project.name} #{@title}"

= render 'projects/side_nav'

- content_for :header do
  .background-gradient
  .header-container
    .container
      %h1.page-heading
        .pull-right
          - if @project.editable_by?(current_user)
            = link_to plus_or('New Site'), new_project_site_path(@project), class: 'btn btn-accent btn-shadow'
          .per-page= render 'layouts/per_page', per_page: 40, object_count: @sites.total_count
        = @title

.dashboard-container
  %table.table.table-striped.table-borderless.table-hover
    %col.hidden-xs{ width: '1px' }
    %col
    %col.hidden-xs
    %col{ width: '1px' }
    %thead
      %tr
        = th_sort_field @order, 'sites.name', 'Number', extra_class: 'hidden-xs center'
        = th_sort_field @order, 'sites.name', 'Name'
        = th_sort_field @order, 'sites.user_id', 'Creator', extra_class: 'hidden-xs'
        %th Actions

    - @sites.each do |site|
      %tr{ id: "site_#{site.id}" }
        %td.hidden-xs.center= site.number
        %td= link_to site.name, [site.project, site]
        %td.hidden-xs= link_to site.user.name, site.user if site.user
        %td
          - if current_user.all_sites.pluck(:id).include?(site.id)
            = render 'layouts/edit_delete_dropdown', edit_url: edit_project_site_path(site.project, site), delete_url: [site.project, site], delete_confirmation: "Delete #{site.name}?"

.center= paginate @sites, theme: 'bootstrap'
