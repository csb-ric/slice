- percent = @export.total_steps > 0 ? @export.steps_completed * 100 / @export.total_steps : 100
- percent = 0 if @export.total_steps == 0 && %w(pending failed).include?(@export.status)
- status = "danger"
- status = "warning" if percent >= 33
- status = "primary" if percent == 100

.progress.shadow
  .progress-bar.progress-bar-striped{ class: "bg-#{status}", style: "width: #{percent}%" }
    = @export.steps_completed
    of
    = @export.total_steps
    = surround "(", "%)" do
      = percent

.dashboard-container
  %table.table.table-borderless
    %col.d-none.d-sm-table-column{ width: "30%" }
    %col.d-table-column.d-sm-none{ width: "50%" }
    %tr
      %th File
      %td
        - if @export.file_size.positive?
          - full_url = file_project_export_path(@project, @export)
          = link_to @export.file.to_s.split("/").last, full_url, target: "_blank", class: "btn btn-light btn-sm"
          %code= number_to_human_size @export.file_size
          %div{ style: "margin-top: 10px;" }
            %small.text-muted
              Export took
              = succeed "." do
                = distance_of_time_in_words @export.created_at, @export.file_created_at, { include_seconds: true }
        - elsif @export.status == "failed"
          %small.text-muted
            Export took
            = succeed "." do
              = distance_of_time_in_words @export.created_at, @export.updated_at, { include_seconds: true }
          = @export.details
        - else
          %small.text-muted
            Export started
            = distance_of_time_in_words @export.created_at, Time.zone.now, { include_seconds: true }
            ago...
