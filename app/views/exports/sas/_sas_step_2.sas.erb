<% variables = (use_grids ? @export_formatter.grid_variables : @export_formatter.variables) %>
<% format_labels = variables.collect(&:sas_format_label).flatten.compact.uniq %>

/* Step 2: Apply labels to variables using slice display names */

data slice<%= '_grids' if use_grids %>;
  set slice<%= '_grids' if use_grids %>;

  /* Design and Subject Variables */
  label _sheet_id='Sheet ID';
  label _name='Design Name';
  label _description='Design Description';
  label _sheet_creation_date='Sheet Creation Date';
  label _project='Project';
  label _site='Site';
  label _subject='Subject ID';
  label _acrostic='Subject Acrostic';
  label _status='Subject Status';
  label _creator='Sheet Creator';
  label _schedule_name='Schedule Name';
  label _event_name='Event Name';

  /* Sheet Variables */
<%= format_labels.join("\n") %>
run;
