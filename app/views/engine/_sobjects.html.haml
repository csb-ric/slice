- @sobjects = @engine.interpreter.sobjects.first(10)

- (sobject_key, first_sobject) = @sobjects.first

- @debug = true || params[:debug] == "1"

- if @sobjects.present?
  %table.table.table-striped.table-borderless
    %thead
      %tr
        %th Internal Subject ID
        - first_sobject.cells.each do |key, _|
          - if key[0] != "_" || @debug
            %th= key
    %tbody
      - @sobjects.each do |_key, sobject|
        - @subject = @project.subjects.find_by(id: sobject.subject_id)
        %tr
          %td= link_to @subject.subject_code, [@project, @subject]
          - sobject.cells.each do |key, cell|
            - if key[0] != "_" || @debug
              %td
                - if cell.value.nil?
                  - if cell.sheet_id
                    = link_to "nil", project_sheet_path(@project, cell.sheet_id), class: "text-muted"
                  - else
                    %span.text-muted nil
                - elsif cell.missing? || cell.value == false
                  - if cell.sheet_id
                    = link_to cell.value.to_s, project_sheet_path(@project, cell.sheet_id), class: "text-danger"
                  - else
                    %span.text-danger= cell.value
                - else
                  - if cell.sheet_id
                    = link_to cell.value.to_s, project_sheet_path(@project, cell.sheet_id), class: "link-blend"
                  - else
                    = cell.value
                - if cell.coverage
                  %span.text-muted.small
                    = surround "(", "%)" do
                      = cell.coverage
