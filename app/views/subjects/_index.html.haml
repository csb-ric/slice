- content_for :header do
  .background-gradient
  .header-container
    .container
      %h1.page-heading
        .pull-right
          - if @project.site_or_project_editor?(current_user)
            = link_to plus_or('New Subject'), new_project_subject_path(@project), class: 'btn btn-accent btn-shadow'
          .per-page= render 'layouts/per_page', per_page: 20, object_count: @subjects.total_count
        = render 'layouts/side_nav_header_button'
        = @title


= form_tag choose_site_project_subjects_path(@project), method: :get, class: 'form-inline', id: 'subject-search-form', style: 'margin-bottom: 20px' do
  .form-group{ style: 'margin: 0; margin-top:-12px' }
    .input-group{ style: 'width: 1px' }
      = text_field_tag :subject_code, '', autocomplete: 'off', id: 'subject-search', class: 'form-control', data: { project_slug: @project.to_param }, placeholder: 'Lookup Subject'
      %span.input-group-btn{ style: 'vertical-align: bottom;' }
        = submit_tag 'Go', class: 'btn btn-default'

= render 'subjects/subjects'

.jumbotron
  = form_tag project_subjects_path(@project), method: :get, id: "subjects_search", class: 'form-vertical' do
    = hidden_field_tag :order, params[:order]
    .row
      .col-md-6.form-group
        = label :search, 'Search', class: 'col-md-3 control-label'
        .col-md-9
          = text_field_tag 'search', params[:search], class: 'form-control'

    .row
      - event = @project.events.find_by_id(params[:event_id])
      - without_event = @project.events.find_by_id(params[:without_event_id])
      - on_event_design = @project.designs.find_by_id(params[:on_event_design_id])
      - not_on_event_design = @project.designs.find_by_id(params[:not_on_event_design_id])
      - if event && on_event_design
        .col-md-12.form-group
          %label.col-md-3.control-label With Design on Event
          .col-md-9
            = hidden_field_tag :event_id, params[:event_id]
            = hidden_field_tag :on_event_design_id, params[:on_event_design_id]
            = on_event_design.name
            on
            = event.name
      - elsif event && not_on_event_design
        .col-md-12.form-group
          %label.col-md-3.control-label Without Design on Event
          .col-md-9
            = hidden_field_tag :event_id, params[:event_id]
            = hidden_field_tag :not_on_event_design_id, params[:not_on_event_design_id]
            = not_on_event_design.name
            not on
            = event.name
      - elsif event
        .col-md-12.form-group
          %label.col-md-3.control-label With Event
          .col-md-9
            = hidden_field_tag :event_id, params[:event_id]
            = event.name
      - elsif without_event
        .col-md-12.form-group
          %label.col-md-3.control-label Without Event
          .col-md-9
            = hidden_field_tag :without_event_id, params[:without_event_id]
            = without_event.name
      - else
        .col-md-6.form-group
          = label :without_design_id, 'Without Design', class: 'col-md-3 control-label'
          .col-md-9
            = select_tag :without_design_id, options_for_select([['---', nil]] + @project.designs.order('name').collect{|d| [d.name, d.id]}, params[:without_design_id] ), class: 'form-control'

        .col-md-6.form-group
          %label.col-md-3.control-label With Design
          .col-md-9
            = select_tag :design_id, options_for_select([['---', nil]] + @project.designs.order('name').collect{|d| [d.name, d.id]}, params[:design_id] ), class: 'form-control'

    .form-group
      .col-md-10.col-md-offset-2
        = submit_tag 'Search', class: 'btn btn-primary', name: nil
        = link_to 'Reset', project_subjects_path(@project), class: 'btn btn-default'
