<% @title = 'Subjects' %>
<div class="page-header">
  <h1>
    <%= link_to @project.name, @project %> &middot; <%= @title %>
    <%= link_to "Create Subject", new_project_subject_path(@project), class: 'btn btn-mini btn-primary' if current_user.all_viewable_projects.pluck(:id).include?(@project.id) %>
  </h1>
</div>

<%= form_tag project_subjects_path(@project), method: :get, remote: true, id: "subjects_search", class: 'form-search', data: { object: 'form-load' } do %>
  <%= hidden_field_tag :order %>
  <div class="row">
    <div class="span4 control-group">
      <%= label :search, 'Search', class: 'control-label' %>
      <div class="controls">
        <%= text_field_tag 'search', params[:search], class: 'search-query', data: { object: 'filter' } %>
      </div>
    </div>

    <div class="span4 control-group">
      <label class="control-label">Subjects</label>
      <div class="controls">
        <div class="btn-group" data-toggle="buttons-checkbox">
          <% Subject::STATUS.each do |label, value| %>
            <button data-object="set-statuses" data-value="<%= value %>" data-target="#subjects_search" type="button" class="btn btn-mini <%= 'active' if @statuses.include?(value) %>">
              <%= label.humanize %>
              <%= hidden_field_tag "statuses[]", @statuses.include?(value) ? value : '', id: "statuses_#{value}" %>
            </button>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="span4 control-group" id="select_site">
      <%= hidden_field_tag :site_id, params[:site_id] %>
      <%#= render partial: 'subjects/select_site' %>
    </div>

    <div class="span4 control-group" id="select_design">
      <%= hidden_field_tag :design_id, params[:design_id] %>
      <%#= render partial: 'subjects/select_design' %>
    </div>
  </div>

  <div class="form-actions">
    <%= submit_tag 'Search', class: 'btn btn-primary' %>
    <%= link_to 'Reset', '#', class: 'btn', data: { target: '#subjects_search', object: 'reset-filters' } %>
  </div>
<% end %>

<div id="subjects"><div class="center"><%= image_tag "contour/ajax-loader.gif" %></div></div>
