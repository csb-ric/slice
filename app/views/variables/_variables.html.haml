.dashboard-container
  %table.table.table-striped.table-borderless.table-hover
    %col.hidden-xs.hidden-sm.hidden-md
    %col.hidden-xs.hidden-sm
    %col
    %col.hidden-xs
    %col.hidden-xs
    %col{ width: '1px' }
    %thead
      %tr
        %th.hidden-xs.hidden-sm.hidden-md.nowrap # Designs
        = th_sort_field @order, 'variables.name', 'Name', extra_class: 'hidden-xs hidden-sm'
        = th_sort_field @order, 'variables.display_name', 'Display Name'
        %th.nowrap.hidden-xs{ class: ['variables.variable_type', 'variables.variable_type desc'].include?(params[:order]) ? 'sort-selected' : nil }
          = link_to 'Variable Type', project_variables_path(@project, order: (params[:order] == 'variables.variable_type desc' ? 'variables.variable_type' : 'variables.variable_type desc'), variable_type: params[:variable_type])
          .dropdown{ style: 'display: inline-block' }
            = link_to '#', data: { target: '#', toggle: 'dropdown' }, role: 'button', aria: { haspopup: 'true', expanded: 'false' } do
              %span.glyphicon.glyphicon-filter
            %ul.dropdown-menu
              %li= link_to 'All Variables', project_variables_path(@project, order: params[:order]), style: params[:variable_type].blank? ? 'font-weight:bold;' : ''
              - Variable::TYPE.each do |variable_type_label, variable_type_value|
                %li= link_to variable_type_label, project_variables_path(@project, order: params[:order], variable_type: variable_type_value), style: params[:variable_type].to_s == variable_type_value.to_s ? 'font-weight:bold;' : ''
        = th_sort_field @order, 'variables.options', 'Options', extra_class: 'hidden-xs'
        %th Actions

    - @variables.each do |variable|
      %tr{ id: "variable_#{variable.id}" }
        %td.hidden-xs.hidden-sm.hidden-md= variable.inherited_designs.count
        %td.hidden-xs.hidden-sm= link_to variable.name, [variable.project, variable]
        %td= link_to variable.display_name, [variable.project, variable]
        %td.hidden-xs
          %code= variable.variable_type
        %td.hidden-xs
          - if variable.shared_options.present?
            = select_tag "variable_#{variable.id}_options", options_for_select(variable.shared_options.collect { |d| "#{d[:value]}: #{d[:name]}" }), style: 'width:200px', class: 'form-control'
        %td.nowrap
          .dropdown
            = link_to '#', class: 'btn btn-default btn-xs dropdown-toggle', data: { toggle: 'dropdown' } do
              Actions
              %strong.caret

            %ul.dropdown-menu.dropdown-menu-right
              %li
                = link_to copy_project_variable_path(variable.project, variable) do
                  %span.glyphicon.glyphicon-copy
                  Copy
              - if variable.editable_by?(current_user)
                %li
                  = link_to edit_project_variable_path(variable.project, variable) do
                    %span.glyphicon.glyphicon-edit
                    Edit
                %li.divider{ role: 'separator' }
                %li
                  = link_to [variable.project, variable], method: :delete, data: { confirm: "Are you sure you want to delete Variable #{variable.name}?" } do
                    .text-danger
                      %span.glyphicon.glyphicon-trash
                      Delete

.center
  = paginate @variables, theme: 'bootstrap'
