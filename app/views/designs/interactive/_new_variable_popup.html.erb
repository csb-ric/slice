<div class="page-header">
  <h1>
    Insert <%= params[:variable_type].to_s.titleize %> Variable
    <%= link_to 'back to variable types', '#', data: { object: 'pull-partial-edit', new: 'section_or_variable', position: params[:position] }, class: 'btn btn-mini' %>
  </h1>
</div>

<div class="row-fluid">
  <span class="span6">
    <form id="variable_form" class="form-horizontal">
      <div class="control-group">
        <label class="control-label">Display Name</label>
        <div class="controls">
          <%= text_field_tag "variable[display_name]", '', style: 'width:95%', autocomplete: 'off', data: { object: 'create-variable-name', target: '#variable_name, #variable_name_display' } %>
          <%= hidden_field_tag "variable[variable_type]", params[:variable_type] %>
        </div>
      </div>

      <div class="control-group">
        <label class="control-label">Name</label>
        <div class="controls">
          <%= hidden_field_tag "variable[name]" %>
          <%= text_field_tag "variable_name_display", '', maxlength: 32, style: 'width:95%', autocomplete: 'off', disabled: true, data: { placement: 'right' } %>
        </div>
      </div>

      <div class="form-actions">
        <%= button_tag 'Insert', data: { object: 'push-partial-change', target: '#variable_form', create: 'variable', position: params[:position] }, class: 'btn btn-primary' %>
      </div>
    </form>
  </span>

  <% if @design.variable_ids.blank? %>
    <% variables = @project.variables.where(variable_type: params[:variable_type]) %>
  <% else %>
    <% variables = @project.variables.where(variable_type: params[:variable_type]).where("variables.id NOT IN (?)", @design.variable_ids) %>
  <% end %>
  <% if variables.count > 0 %>
    <span class="span6">
      Or Select Existing Variable
      <%= select_tag 'variable[id]', options_for_select( [['', nil]] + variables.collect{|v| [v.display_name, v.id]} ), class: "chzn-select" %>
      <%= button_tag 'Insert Existing Variable', data: { object: 'push-partial-change', target: '#variable_id', create: 'variable', position: params[:position] }, class: 'btn btn-primary' %>
    </span>
  <% end %>
</div>

<hr class="soften" style="margin-top:20px;" />

<div class="button-group pull-right">
  <%= button_tag 'Cancel', data: { object: 'hide-contour-modal', position: params[:position] }, class: 'btn' %>
</div>

