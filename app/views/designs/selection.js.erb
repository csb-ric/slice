$("#design").html("<%= escape_javascript(render("designs/selection")) %>");
$('.timepicker').timepicker({ 'timeFormat': 'H:i:s' });
$('.chzn-select').chosen({ allow_single_deselect: true });
$(".datepicker").datepicker({
  showOtherMonths: true,
  selectOtherMonths: true,
  changeMonth: true,
  changeYear: true
});
$("#ui-datepicker-div").hide();

<% if @design %>
  <% @design.options.each do |option| %>
    <% @option = option %>
    <% if @option[:variable_id].blank? %>
      $('#<%= @option[:section_id] %>').data('branching-logic', <%= raw @design ? @design.branching_logic_section(@option[:section_id]) : ''.to_json %>);
    <% elsif @variable = Variable.current.find_by_id(@option[:variable_id]) %>
      $('#varvar_<%= @variable.id %>').data('values-hash', <%= raw @design ? @design.values_hash(@variable) : [].to_json %>);
      $('#varvar_<%= @variable.id %>').data('branching-logic', <%= raw @design ? @design.branching_logic(@variable) : ''.to_json %>);
    <% end %>
  <% end %>
<% end %>

updateAllVariables();
updateCalculatedVariables();

$("[rel=popover]").popover({offset: 10});

$('[data-spy="scroll"]').each(function () {
  var $spy = $(this).scrollspy('refresh')
});
