- @title = 'Designs'
- @menu_title = "#{@project.name} #{@title}"

= render 'projects/side_nav'

- content_for :header do
  .background-gradient
  .header-container
    .container
      %h1.page-heading
        .pull-right
          = link_to plus_or('New Design'), new_project_design_path(@project), class: 'btn btn-accent btn-shadow'
          .per-page= render 'layouts/per_page', per_page: 40, object_count: @designs.total_count
        = @title
        = render 'search/toggle'

= render 'search/simple', url: project_designs_path(@project)

- if @designs.present?
  .dashboard-container
    %table.table.table-striped
      %col{ width: '1px' }
      %col
      %col.hidden-xs
      %col.hidden-xs
      %col{ width: '1px' }
      %thead
        %tr
          %th Abbr
          = th_sort_field @order, 'designs.name', 'Name'
          %th.hidden-xs Variables
          %th.hidden-xs.nowrap{ class: ['designs.category_name', 'designs.category_name desc'].include?(params[:order]) ? 'sort-selected' : nil }
            = link_to 'Category', project_designs_path(@project, order: (params[:order] == 'designs.category_name' ? 'designs.category_name desc' : 'designs.category_name'), category_id: params[:category_id])
            .dropdown{ style: 'display: inline-block' }
              = link_to '#', data: { target: '#', toggle: 'dropdown' }, role: 'button', aria: { haspopup: 'true', expanded: 'false' } do
                %span.glyphicon.glyphicon-filter
              %ul.dropdown-menu.dropdown-menu-right
                %li= link_to 'All Categories', project_designs_path(@project, order: params[:order]), style: params[:category_id].blank? ? 'font-weight:bold;' : ''
                - @project.categories.each do |category|
                  %li= link_to category.name, project_designs_path(@project, order: params[:order], category_id: category.id), style: params[:category_id].to_s == category.id.to_s ? 'font-weight:bold;' : ''
          %th Actions

      - @designs.each do |design|
        %tr{ id: "design_#{design.id}" }
          %td.nowrap= design.short_name
          %td
            = link_to design.name, [@project, design]
            = render 'layouts/unblinded_only', project: @project, object: design, placement: 'right'
          %td.hidden-xs= design.variables.count
          %td.hidden-xs= design.category.name if design.category
          %td
            = render 'layouts/edit_delete_dropdown', edit_url: edit_project_design_path(@project, design), delete_url: [@project, design], delete_confirmation: "Delete #{design.name}?"
  .center
    = paginate @designs, theme: 'bootstrap'
- else
  .jumbotron
    %p.center No designs found.

.docs-learn-more
  Learn about
  = succeed '.' do
    = link_to 'designs', docs_designs_path
