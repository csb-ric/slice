- @title = "My Settings"

- content_for :header, @title

.row
  .col-md-6
    .card
      .card-header
        - if current_user.theme == "spring"
          %span.fa-stack.flower-stack
            %i.fa.fa-pagelines.fa-stack-1x
            %i.fa.fa-circle.fa-stack-1x
            %i.fa.fa-sun-o.fa-stack-1x
        - else
          %i.fa.fa-cog
        My Settings
      .card-body

        = form_with model: current_user, url: settings_path, method: :post, local: true do |form|
          = render "forms/vertical/text_field", form: form, object: current_user, key: :full_name
          = render "forms/vertical/email_field", form: form, object: current_user, key: :email
          = render "forms/vertical/check_box", form: form, object: current_user, key: :emails_enabled, help_text: "Allow #{ENV["website_name"]} to send you emails. Unchecking this box will disable all emails except for password reset and account unlock emails."
          = render "forms/vertical/select", form: form, object: current_user, key: :theme, options: Slice::THEMES, include_blank: "Default"
          = render "forms/vertical/check_box", form: form, object: current_user, key: :sound_enabled, help_text: "Enable audio alerts when entering data."
          = render "forms/vertical/submit", form: form, object: current_user, submit_text: "Save Settings", cancel: false

  .col-md-6
    .card.mb-4
      .card-header
        %i.fa.fa-lock
        Change Password
      .card-body
        = form_with model: current_user, url: change_password_path, method: :patch, local: true, id: "reset_password" do |form|
          = render "forms/vertical/password_field", form: form, object: current_user, key: :current_password, key_name: "Old password", autocomplete: "current-password"
          = render "forms/vertical/password_field", form: form, object: current_user, key: :password, key_name: "New password", autocomplete: "new-password"
          = render "forms/vertical/password_field", form: form, object: current_user, key: :password_confirmation, key_name: "Confirm new password", autocomplete: "new-password"
          = render "forms/vertical/submit", form: form, object: current_user, submit_text: "Update password", cancel: false

      .card-footer
        - if current_user.password_expires_in > 0
          Your password will expire in
          = pluralize current_user.password_expires_in, "day"
          on
          = current_user.password_expires_on.strftime("%a, %B %-d, %Y.")
        - else
          Your password has expired.

    .card
      .card-header
        My Profile Picture
      .card-body
        .text-center= image_tag current_user.avatar_url(80, "identicon"), class: "img-rounded"
      .card-footer
        You can change your picture at
        = succeed "." do
          = link_to "gravatar.com", "http://gravatar.com"
