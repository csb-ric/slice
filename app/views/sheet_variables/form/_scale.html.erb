<% is_grid = defined?(grid) %>

<% if variable.scale_type == 'radio' %>
  <%= hidden_field_tag "#{field_name}", nil, disabled: disabled, data: { name: variable.name, variable_type: variable.scale_type } %>
<% else %>
  <% responses = ((defined?(sheet_variable) and sheet_variable) ? sheet_variable.responses.pluck(:value) : []) %>
  <%= hidden_field_tag "#{field_name}[]", nil, disabled: disabled, data: { name: variable.name, variable_type: variable.scale_type } %>
<% end %>

<table class="table table-hover"><col width="300px"/><%== "<col width='#{100/(variable.options_missing_at_end.size+2)}%'/>"*variable.options_missing_at_end.size %><col width="1px"/>
  <% if variable.first_scale_variable?(@design) %>
    <thead>
      <tr>
        <th></th>
        <% variable.options_missing_at_end.collect{|opt| [opt[:name], opt[:value]]}.each do |name, value| %>
          <th style="text-align:center">
            <%= name %>
          </th>
        <% end %>
        <th></th>
      </tr>
    </thead>
  <% end %>
  <tbody>
    <tr>
      <td><%= variable.display_name %></td>
      <% variable.options_missing_at_end.collect{|opt| [opt[:name], opt[:value]]}.each do |name, value| %>
        <td style="text-align:center" data-content="<%= variable.description %>"
                                      data-title="<%= variable.display_name %>"
                                      data-placement="bottom" rel="<%= variable.description.blank? ? 'tooltip' : 'popover' %>">
          <label class="<%= variable.scale_type %> inline">
            <% if variable.scale_type == 'radio' %>
              <%= radio_button_tag field_name, "#{value}", value == response, data: { object: "condition", name: variable.name, variable_type: variable.scale_type }, disabled: disabled %>
            <% else %>
              <%= check_box_tag "#{field_name}[]", "#{value}", responses.collect{|i| i.to_s}.include?(value), data: { object: "condition", name: variable.name, variable_type: variable.scale_type }, disabled: disabled %>
            <% end %>
          </label>
        </td>
      <% end %>
      <td style="text-align:right">
        <% if variable.scale_type == 'radio' %>
          <%= link_to 'clear', '#', class: 'btn btn-mini', data: { object: 'clear-radio', group: field_name }, tabindex: "-1" unless disabled %>
        <% else %>
          <%= link_to 'clear', '#', class: 'btn btn-mini', data: { object: 'clear-checkbox', group: "#{field_name}[]" }, tabindex: "-1" unless disabled %>
        <% end %>
      </td>
    </tr>
  </tbody>
</table>
