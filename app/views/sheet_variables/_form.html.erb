<% sheet_variable = (@sheet ? @sheet.sheet_variables.find_by_variable_id(variable.id) : nil) %>
<% response = (params[:variables].blank? ? (sheet_variable ? sheet_variable.response : nil) : params[:variables][variable.id.to_s]) %>

<% if Variable::TYPE.flatten.uniq.include?(variable.variable_type) %>
  <%= render partial: "sheet_variables/form/#{variable.variable_type}", locals: { response: response, disabled: disabled, variable: variable, field_name: "variables[#{variable.id}]" } %>
<% else %>
  <%= hidden_field_tag "variables[#{variable.id}]", nil, disabled: disabled %>
  Unsupported Variable Type <%= variable.variable_type %>
<% end %>
